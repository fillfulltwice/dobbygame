// js/data/translations.js
export const TRANSLATIONS = {
    ru: {
        game: {
            title: 'üêï Dobby\'s Absurd Alchemy',
            subtitle: '–°–æ–∑–¥–∞–≤–∞–π –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ–µ —Å –ø–æ–º–æ—â—å—é –±–µ–∑—É–º–Ω–æ–≥–æ AI-–∞–ª—Ö–∏–º–∏–∫–∞!',
            powered_by: '–ù–∞ –±–∞–∑–µ Sentient AI: dobby-unhinged-llama-3-3-70b'
        },
        
        stats: {
            level: 'üé≠ –£—Ä–æ–≤–µ–Ω—å',
            exp: '‚≠ê –û–ø—ã—Ç',
            coins: 'ü™ô –ú–æ–Ω–µ—Ç—ã',
            elements: 'üîÆ –≠–ª–µ–º–µ–Ω—Ç—ã',
            meat: 'üçñ –ú—è—Å–æ',
            bones: 'ü¶¥ –ö–æ—Å—Ç–∏'
        },
        
        tabs: {
            game: 'üéÆ –ò–≥—Ä–∞',
            shop: 'üè™ Dobby Shop',
            tree: 'üå≥ –î—Ä–µ–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤',
            leaderboard: 'üèÜ –õ–∏–¥–µ—Ä–±–æ—Ä–¥',
            settings: '‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏'
        },
        
        panels: {
            inventory: 'üì¶ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å',
            dobby: 'üêï Dobby AI Assistant',
            crafting: 'üî® –ú–∞—Å—Ç–µ—Ä—Å–∫–∞—è –∞–±—Å—É—Ä–¥–∞',
            shop_title: 'üè™ Dobby Shop - –ú–∞–≥–∞–∑–∏–Ω –±–µ–∑—É–º–∏—è',
            your_coins: '–¢–≤–æ–∏ –º–æ–Ω–µ—Ç—ã:'
        },
        
        dobby: {
            loyalty: '–õ–æ—è–ª—å–Ω–æ—Å—Ç—å',
            trust: '–î–æ–≤–µ—Ä–∏–µ',
            chat_placeholder: '–ü–æ–≥–æ–≤–æ—Ä–∏ —Å Dobby... (Enter –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏)',
            chat_button: 'üí¨ –°–∫–∞–∑–∞—Ç—å Dobby',
            give_meat: 'üçñ –î–∞—Ç—å –º—è—Å–æ',
            give_bone: 'ü¶¥ –î–∞—Ç—å –∫–æ—Å—Ç—å',
            thinking: 'Dobby –¥—É–º–∞–µ—Ç...',
            sniffing: 'Dobby –æ–±–Ω—é—Ö–∏–≤–∞–µ—Ç —Ç–≤–æ–∏ —Å–ª–æ–≤–∞...',
            complete_request: '–í—ã–ø–æ–ª–Ω–∏—Ç—å',
            
            greetings: {
                new_player: '–ì–∞–≤! –ü—Ä–∏–≤–µ—Ç, {name}! –Ø Dobby - —Å–∞–º—ã–π –±–µ–∑—É–º–Ω—ã–π –∞–ª—Ö–∏–º–∏–∫-–ø—ë—Å –≤–æ –≤—Å–µ–ª–µ–Ω–Ω–æ–π! üêï\n\n–Ø –∑–Ω–∞—é —Ä–µ—Ü–µ–ø—Ç—ã —Ç–∞–∫–∏—Ö –≤–µ—â–µ–π, –æ—Ç –∫–æ—Ç–æ—Ä—ã—Ö —É –æ–±—ã—á–Ω—ã—Ö –∞–ª—Ö–∏–º–∏–∫–æ–≤ –≥–æ–ª–æ–≤–∞ –∫—Ä—É–≥–æ–º –ø–æ–π–¥—ë—Ç! –ù–æ —Å–Ω–∞—á–∞–ª–∞ –º–Ω–µ –Ω—É–∂–Ω–æ —É–∑–Ω–∞—Ç—å, –º–æ–∂–Ω–æ –ª–∏ —Ç–µ–±–µ –¥–æ–≤–µ—Ä—è—Ç—å...',
                returning: '–ì–∞–≤! {name}, —Ç—ã –≤–µ—Ä–Ω—É–ª—Å—è! –Ø —Å–∫—É—á–∞–ª! üêï',
                first_time: '–ì–∞–≤! –Ø Dobby! üêï –Ø –∑–Ω–∞—é –≤—Å–µ —Å–µ–∫—Ä–µ—Ç—ã –∞–ª—Ö–∏–º–∏–∏... –Ω–æ —Å–Ω–∞—á–∞–ª–∞ –¥–∞–≤–∞–π –ø–æ–∑–Ω–∞–∫–æ–º–∏–º—Å—è!'
            },
            
            moods: {
                happy: 'Dobby —Å—á–∞—Å—Ç–ª–∏–≤! *–≤–∏–ª—è–µ—Ç —Ö–≤–æ—Å—Ç–æ–º*',
                neutral: '–ì–∞–≤... —á—Ç–æ —Ç–µ–±–µ –Ω—É–∂–Ω–æ?',
                angry: '–ì—Ä—Ä—Ä—Ä... Dobby –Ω–µ –¥–æ–≤–æ–ª–µ–Ω!',
                loving: '–¢—ã –º–æ–π –ª—É—á—à–∏–π –¥—Ä—É–≥! ü•∞'
            },
            
            requests: [
                '–ü—Ä–∏–Ω–µ—Å–∏ –º–Ω–µ 2 –û–≥–Ω—è, –∏ —è —Ä–∞—Å—Å–∫–∞–∂—É —Å–µ–∫—Ä–µ—Ç –ü–∞—Ä–∞!',
                '–ú–Ω–µ –Ω—É–∂–Ω—ã 3 –í–æ–¥—ã –¥–ª—è –∫—É–ø–∞–Ω–∏—è! –î–∞—à—å - —Ä–∞—Å—Å–∫–∞–∂—É –ø—Ä–æ –õ—ë–¥!',
                '–•–æ—á—É –°–º–µ—Ö! –ü—Ä–∏–Ω–µ—Å–∏, –∏ —É–∑–Ω–∞–µ—à—å –ø—Ä–æ –ó–æ–ª–æ—Ç–æ!',
                '–î–∞–π –º–Ω–µ –Ø–π—Ü–æ, —Ä–∞—Å—Å–∫–∞–∂—É –ø—Ä–æ –¥—Ä–∞–∫–æ–Ω–æ–≤!'
            ]
        },
        
        crafting: {
            mix_button: '‚ú® –°–º–µ—à–∞—Ç—å –±–µ–∑—É–º–∏–µ ‚ú®',
            min_elements: '–ù—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 2 —ç–ª–µ–º–µ–Ω—Ç–∞!',
            recipe_not_found: '‚ùå –†–µ—Ü–µ–ø—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω! –°–ø—Ä–æ—Å–∏ —É Dobby!',
            success: '‚ú® –°–æ–∑–¥–∞–Ω–æ: {element}! ‚ú®',
            failed: '–≠—Ç–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç... –ú–æ–∂–µ—Ç Dobby –∑–Ω–∞–µ—Ç —Å–µ–∫—Ä–µ—Ç?'
        },
        
        shop: {
            buy_button: '–ö—É–ø–∏—Ç—å',
            not_enough_coins: '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!',
            purchased: '–ö—É–ø–ª–µ–Ω–æ: {item}!'
        },
        
        modals: {
            welcome: {
                title: 'üêï –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!',
                subtitle: '–ö–∞–∫ —Ç–µ–±—è –∑–æ–≤—É—Ç, —é–Ω—ã–π –∞–ª—Ö–∏–º–∏–∫?',
                name_placeholder: '–í–≤–µ–¥–∏ —Å–≤–æ—ë –∏–º—è',
                start_button: '–ù–∞—á–∞—Ç—å –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ!'
            },
            
            unlock: {
                title: 'üéâ –ù–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –æ—Ç–∫—Ä—ã—Ç!',
                button: '–û—Ç–ª–∏—á–Ω–æ!'
            },
            
            settings: {
                title: '‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏',
                api_key: 'API –∫–ª—é—á Fireworks AI',
                save_button: '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å',
                reset_button: '–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å'
            }
        },
        
        leaderboard: {
            title: 'üèÜ –õ–∏–¥–µ—Ä–±–æ—Ä–¥',
            titles: {
                1: '–ù–∞—á–∏–Ω–∞—é—â–∏–π –ê–ª—Ö–∏–º–∏–∫',
                5: '–î—Ä—É–≥ Dobby',
                10: '–ë–µ–∑—É–º–Ω—ã–π –£—á—ë–Ω—ã–π',
                15: '–£–∫—Ä–æ—Ç–∏—Ç–µ–ª—å –°—Ç–∏—Ö–∏–π',
                20: '–ú–∞—Å—Ç–µ—Ä –•–∞–æ—Å–∞',
                25: '–ü–æ–≤–µ–ª–∏—Ç–µ–ª—å –ê–±—Å—É—Ä–¥–∞'
            }
        },
        
        messages: {
            daily_bonus: 'üéÅ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å: +50 ü™ô +2 üçñ +3 ü¶¥',
            level_up: 'üéâ –£—Ä–æ–≤–µ–Ω—å {level}! +{meat} üçñ +{bones} ü¶¥ +{coins} ü™ô',
            trust_gained: '+{amount} –¥–æ–≤–µ—Ä–∏—è! Dobby —Ä–∞–¥!',
            loyalty_gained: '+{amount} –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏!',
            api_key_required: '–í–≤–µ–¥–∏—Ç–µ –≤–∞—à API –∫–ª—é—á –¥–ª—è Fireworks AI:',
            api_error: '–ì–∞–≤! *Dobby —á–∏—Ö–Ω—É–ª* –ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫... –ü—Ä–æ–≤–µ—Ä—å API –∫–ª—é—á!'
        },
        
        settings: {
            language: '–Ø–∑—ã–∫',
            theme: '–¢–µ–º–∞',
            themes: {
                light: '–°–≤–µ—Ç–ª–∞—è',
                dark: '–¢—ë–º–Ω–∞—è',
                auto: '–ê–≤—Ç–æ'
            },
            autosave: '–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ',
            notifications: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è',
            export: '–≠–∫—Å–ø–æ—Ä—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è',
            import: '–ò–º–ø–æ—Ä—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è',
            reset: '–°–±—Ä–æ—Å–∏—Ç—å –∏–≥—Ä—É',
            importSuccess: '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ!',
            importError: '–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è',
            resetConfirm: '–í—ã —É–≤–µ—Ä–µ–Ω—ã? –í–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å –±—É–¥–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω!',
            resetSuccess: '–ò–≥—Ä–∞ —Å–±—Ä–æ—à–µ–Ω–∞'
        },
        
        production: {
            count: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ',
            rate: '–°–∫–æ—Ä–æ—Å—Ç—å'
        },
        
        currency: {
            coins: '–º–æ–Ω–µ—Ç—ã'
        },
        
        items: {},
        buildings: {},
        resources: {}
    },
    
    en: {
        game: {
            title: 'üêï Dobby\'s Absurd Alchemy',
            subtitle: 'Create the impossible with a crazy AI alchemist!',
            powered_by: 'Powered by Sentient AI: dobby-unhinged-llama-3-3-70b'
        },
        
        stats: {
            level: 'üé≠ Level',
            exp: '‚≠ê Experience',
            coins: 'ü™ô Coins',
            elements: 'üîÆ Elements',
            meat: 'üçñ Meat',
            bones: 'ü¶¥ Bones'
        },
        
        tabs: {
            game: 'üéÆ Game',
            shop: 'üè™ Dobby Shop',
            tree: 'üå≥ Element Tree',
            leaderboard: 'üèÜ Leaderboard',
            settings: '‚öôÔ∏è Settings'
        },
        
        panels: {
            inventory: 'üì¶ Inventory',
            dobby: 'üêï Dobby AI Assistant',
            crafting: 'üî® Absurdity Workshop',
            shop_title: 'üè™ Dobby Shop - Madness Store',
            your_coins: 'Your coins:'
        },
        
        dobby: {
            loyalty: 'Loyalty',
            trust: 'Trust',
            chat_placeholder: 'Talk to Dobby... (Enter to send)',
            chat_button: 'üí¨ Tell Dobby',
            give_meat: 'üçñ Give meat',
            give_bone: 'ü¶¥ Give bone',
            thinking: 'Dobby is thinking...',
            sniffing: 'Dobby is sniffing your words...',
            complete_request: 'Complete',
            
            greetings: {
                new_player: 'Woof! Hello, {name}! I\'m Dobby - the craziest alchemist dog in the universe! üêï\n\nI know recipes for things that would make ordinary alchemists dizzy! But first I need to know if I can trust you...',
                returning: 'Woof! {name}, you\'re back! I missed you! üêï',
                first_time: 'Woof! I\'m Dobby! üêï I know all the secrets of alchemy... but let\'s get acquainted first!'
            },
            
            moods: {
                happy: 'Dobby is happy! *wags tail*',
                neutral: 'Woof... what do you need?',
                angry: 'Grrrr... Dobby is not pleased!',
                loving: 'You\'re my best friend! ü•∞'
            },
            
            requests: [
                'Bring me 2 Fire, and I\'ll tell you the secret of Steam!',
                'I need 3 Water for bathing! Give them and I\'ll tell you about Ice!',
                'I want Laughter! Bring it, and you\'ll learn about Gold!',
                'Give me an Egg, I\'ll tell you about dragons!'
            ]
        },
        
        crafting: {
            mix_button: '‚ú® Mix the Madness ‚ú®',
            min_elements: 'Need at least 2 elements!',
            recipe_not_found: '‚ùå Recipe not found! Ask Dobby!',
            success: '‚ú® Created: {element}! ‚ú®',
            failed: 'This combination doesn\'t work... Maybe Dobby knows the secret?'
        },
        
        shop: {
            buy_button: 'Buy',
            not_enough_coins: 'Not enough coins!',
            purchased: 'Purchased: {item}!'
        },
        
        modals: {
            welcome: {
                title: 'üêï Welcome!',
                subtitle: 'What\'s your name, young alchemist?',
                name_placeholder: 'Enter your name',
                start_button: 'Start adventure!'
            },
            
            unlock: {
                title: 'üéâ New element unlocked!',
                button: 'Great!'
            },
            
            settings: {
                title: '‚öôÔ∏è Settings',
                api_key: 'Fireworks AI API Key',
                save_button: 'Save',
                reset_button: 'Reset progress'
            }
        },
        
        leaderboard: {
            title: 'üèÜ Leaderboard',
            titles: {
                1: 'Beginner Alchemist',
                5: 'Dobby\'s Friend',
                10: 'Mad Scientist',
                15: 'Element Tamer',
                20: 'Chaos Master',
                25: 'Lord of Absurdity'
            }
        },
        
        messages: {
            daily_bonus: 'üéÅ Daily bonus: +50 ü™ô +2 üçñ +3 ü¶¥',
            level_up: 'üéâ Level {level}! +{meat} üçñ +{bones} ü¶¥ +{coins} ü™ô',
            trust_gained: '+{amount} trust! Dobby is happy!',
            loyalty_gained: '+{amount} loyalty!',
            api_key_required: 'Enter your Fireworks AI API key:',
            api_error: 'Woof! *Dobby sneezed* Something went wrong... Check the API key!'
        },
        
        settings: {
            language: 'Language',
            theme: 'Theme',
            themes: {
                light: 'Light',
                dark: 'Dark',
                auto: 'Auto'
            },
            autosave: 'Autosave',
            notifications: 'Notifications',
            export: 'Export save',
            import: 'Import save',
            reset: 'Reset game',
            importSuccess: 'Save successfully imported!',
            importError: 'Error importing save',
            resetConfirm: 'Are you sure? All progress will be lost!',
            resetSuccess: 'Game reset'
        },
        
        production: {
            count: 'Count',
            rate: 'Rate'
        },
        
        currency: {
            coins: 'coins'
        },
        
        items: {},
        buildings: {},
        resources: {}
    }
};

// –¢–µ–∫—É—â–∏–π —è–∑—ã–∫
let currentLanguage = localStorage.getItem('gameLanguage') || 'ru';

// –ü–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥
export function t(key, params = {}) {
    const keys = key.split('.');
    let value = TRANSLATIONS[currentLanguage];
    
    for (const k of keys) {
        if (value && value[k]) {
            value = value[k];
        } else {
            // Fallback to Russian
            value = TRANSLATIONS.ru;
            for (const k2 of keys) {
                if (value && value[k2]) {
                    value = value[k2];
                } else {
                    return key; // Return key if translation not found
                }
            }
            break;
        }
    }
    
    // Replace parameters
    if (typeof value === 'string') {
        Object.entries(params).forEach(([param, val]) => {
            value = value.replace(`{${param}}`, val);
        });
    }
    
    return value;
}

// –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —è–∑—ã–∫
export function setLanguage(lang) {
    if (TRANSLATIONS[lang]) {
        currentLanguage = lang;
        localStorage.setItem('gameLanguage', lang);
        updatePageTranslations();
    }
}

// –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π —è–∑—ã–∫
export function getCurrentLanguage() {
    return currentLanguage;
}

// –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –ø–µ—Ä–µ–≤–æ–¥—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
export function updatePageTranslations() {
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        element.textContent = t(key);
    });
    
    document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
        const key = element.getAttribute('data-i18n-placeholder');
        element.placeholder = t(key);
    });
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤
export async function initTranslations() {
    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —è–∑—ã–∫
    const savedLang = localStorage.getItem('gameLanguage');
    if (savedLang && TRANSLATIONS[savedLang]) {
        currentLanguage = savedLang;
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –ø–µ—Ä–µ–≤–æ–¥—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    updatePageTranslations();
    
    console.log('Translations initialized with language:', currentLanguage);
    
    return true;
}